(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return r}),n.d(t,"a",function(){return s});var a=n(53),i=n(39),o=n(40);function r(t,n){return new Promise(function(r,s){var c=i.stringify({encrypted_metadata:t,data:n}),d={hostname:o.awsLambda.saveTaskData.host,port:443,path:o.awsLambda.saveTaskData.path,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":e.byteLength(c)}},l=a.request(d,function(e){e.setEncoding("utf8"),e.on("data",function(){}),e.on("end",r)});l.on("error",function(e){o.debug&&(console.log("ERROR:"),console.log(e)),s(e)}),l.write(c),l.end()})}function s(t){return new Promise(function(n,r){var s=i.stringify({encrypted_metadata:t}),c={hostname:o.awsLambda.fetchLink.host,port:443,path:o.awsLambda.fetchLink.path,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":e.byteLength(s)}},d=a.request(c,function(e){e.setEncoding("utf8");var t="";e.on("data",function(e){t+=e}),e.on("end",function(){return n(t)})});d.on("error",function(e){o.debug&&(console.log("ERROR:"),console.log(e)),r(e)}),d.write(s),d.end()})}}).call(this,n(9).Buffer)},40:function(e){e.exports={taskVersion:"1.0.0",taskName:"visual_qualifying",debug:!1,awsLambda:{saveTaskData:{host:"de8cnjde61.execute-api.us-east-2.amazonaws.com",path:"/default/saveTaskData"},fetchLink:{host:"3pnzb6n9vf.execute-api.us-east-2.amazonaws.com",path:"/default/fetchLink"}}}},45:function(e,t,n){e.exports=n(94)},57:function(e,t){},59:function(e,t){},71:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(42),r=n.n(o),s=n(16),c=n(17),d=n(19),l=n(18),u=n(20),p=n(6),m=n(23),f=(n(71),n(40)),h=n(72),v=n(73);n(85);var b=function(e){function t(e){var n;Object(s.a)(this,t),n=Object(d.a)(this,Object(l.a)(t).call(this,e));var a=v.parse(n.props.location.search,{ignoreQueryPrefix:!0});return n.state={encryptedMetadata:a.id,sendingData:!1,link:void 0},console.log(n.state.encryptedMetadata),h.isUndefined(n.state.encryptedMetadata)||n.addScript("/LabJsWrapper/external/lab.js",function(){n.addScript("/LabJsWrapper/script.js")}),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("message",function(t){if("labjs.data"===t.data.type){var n=JSON.parse(t.data.json);if(f.debug)return void console.log(n);var a={};a.encrypted_metadata=e.state.encryptedMetadata,a.taskName=f.taskName,a.taskVersion=f.taskVersion,a.data=n,e.setState({sendingData:!0}),Object(m.b)(e.state.encryptedMetadata,JSON.stringify(a)).then(function(){console.log("Saved task data"),Object(m.a)(e.state.encryptedMetadata).then(function(t){return e.setState({link:t})})})}})}},{key:"addScript",value:function(e,t){var n=document.createElement("script");n.src=e,n.type="module",n.onreadystatechange=t,n.onload=t,document.head.appendChild(n)}},{key:"render",value:function(){return h.isUndefined(this.state.encryptedMetadata)?i.a.createElement("div",null,i.a.createElement("h2",null,"Something went wrong. Please try again.")):(h.isUndefined(this.state.link)||window.location.assign(this.state.link),i.a.createElement("div",null,i.a.createElement("div",{className:"container fullscreen","data-labjs-section":"main",style:{visibility:this.state.sendingData?"hidden":"visible"}},i.a.createElement("main",{className:"content-vertical-center content-horizontal-center"},i.a.createElement("div",null,i.a.createElement("h2",null,"Loading Experiment"),i.a.createElement("p",null,"The experiment is loading and should start in a few seconds")))),i.a.createElement("div",{style:{visibility:this.state.sendingData?"visible":"hidden"}},i.a.createElement("h2",null,"Saving data... do not exit window"),i.a.createElement("h2",null,"Saving data... do not exit window"),i.a.createElement("h2",null,"Saving data... do not exit window"),i.a.createElement("h2",null,"Saving data... do not exit window"))))}}]),t}(a.Component),g=function(){return i.a.createElement(p.c,null,i.a.createElement(p.a,{path:"/",exact:!0,component:b}))},w=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(g,null))}}]),t}(a.Component),y=n(22),E=n(3);n.d(t,"history",function(){return k});var k=Object(E.a)();r.a.render(i.a.createElement(y.a,{history:k,basename:"/LabJsWrapper"},i.a.createElement(w,null)),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.21bb3e31.chunk.js.map